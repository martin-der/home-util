

def homeutilProjectDir = "${project.projectDir}/.."

def trimWD = {
	it.startsWith(homeutilProjectDir) ? it.substring(homeutilProjectDir.size()) : it
}

task runTests(type: Test) {

	def sourceDir = 'script'
	file("$sourceDir").eachFile { testDir ->
		testDir.eachFile { file ->
			def filename = trimWD("$file")
			println "Testing $filename"
			exec {
				workingDir homeutilProjectDir
				commandLine 'bash', "$file"
			}
		}
	}
}

tasks.withType(Test) {
	runTests
}


